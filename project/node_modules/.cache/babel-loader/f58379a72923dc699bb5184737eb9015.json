{"ast":null,"code":"import{useEffect}from'react';import{Link,useNavigate,useParams}from'react-router-dom';import ButtonAddMyList from'../../components/button-add-my-list/button-add-my-list';import Footer from'../../components/footer/footer';import ListFilms from'../../components/list-films/list-films';import LoginUser from'../../components/login-user/login-user';import Logo from'../../components/logo/logo';import ListTabs from'../../components/tabs/list-tabs/list-tabs';import{APIRoute,AppRoute}from'../../const';import{useAppDispatch,useAppSelector}from'../../hooks';import{redirectToRoute}from'../../store/action';import{fetchLoadCommentsAction,fetchLoadFilmAction,fetchLoadSimilarFilmsAction}from'../../store/api-actions';import{getFilm,getSimilarFilms}from'../../store/data-loading/selector';import{getFilmFoundStatus}from'../../store/film-screening/selector';import{getAuthorizationStatus}from'../../store/user-process/selector';import{isCheckedLogin}from'../../utils';import LoadingScreen from'../loading-screen/loading-screen';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var SIMILAR_FILMS_COUNT=4;function FilmPage(){var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var dispatch=useAppDispatch();var film=useAppSelector(getFilm);var similarFilms=useAppSelector(getSimilarFilms);var isSimilarFilmsLoaded=useAppSelector(getSimilarFilms);var authorizationStatus=useAppSelector(getAuthorizationStatus);var isFilmNotFound=useAppSelector(getFilmFoundStatus);useEffect(function(){dispatch(fetchLoadCommentsAction(id));dispatch(fetchLoadFilmAction(id));dispatch(fetchLoadSimilarFilmsAction(id));},[dispatch,id]);if(isFilmNotFound){dispatch(redirectToRoute(AppRoute.NotFound));}if(!film||!similarFilms){return/*#__PURE__*/_jsx(LoadingScreen,{});}var name=film.name,genre=film.genre,released=film.released,posterImage=film.posterImage,backgroundImage=film.backgroundImage;var clickHandle=function clickHandle(){return navigate(\"/player/\".concat(film.id));};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"section\",{className:\"film-card film-card--full\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"film-card__hero\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"film-card__bg\",children:/*#__PURE__*/_jsx(\"img\",{src:backgroundImage,alt:name})}),/*#__PURE__*/_jsx(\"h1\",{className:\"visually-hidden\",children:\"WTW\"}),/*#__PURE__*/_jsxs(\"header\",{className:\"page-header film-card__head\",children:[/*#__PURE__*/_jsx(Logo,{}),/*#__PURE__*/_jsx(LoginUser,{})]}),/*#__PURE__*/_jsx(\"div\",{className:\"film-card__wrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"film-card__desc\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"film-card__title\",children:name}),/*#__PURE__*/_jsxs(\"p\",{className:\"film-card__meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"film-card__genre\",children:genre}),/*#__PURE__*/_jsx(\"span\",{className:\"film-card__year\",children:released})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"film-card__buttons\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:clickHandle,className:\"btn btn--play film-card__button\",type:\"button\",children:[/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 19 19\",width:\"19\",height:\"19\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"#play-s\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"Play\"})]}),isCheckedLogin(authorizationStatus)?/*#__PURE__*/_jsx(ButtonAddMyList,{idFilm:Number(id)}):'',isCheckedLogin(authorizationStatus)?/*#__PURE__*/_jsx(Link,{to:\"\".concat(APIRoute.Films,\"/\").concat(id,\"/review\"),className:\"btn film-card__button\",children:\"Add review\"}):'']})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"film-card__wrap film-card__translate-top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"film-card__info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"film-card__poster film-card__poster--big\",children:/*#__PURE__*/_jsx(\"img\",{src:posterImage,alt:\"\".concat(name,\" poster\"),width:\"218\",height:\"327\"})}),/*#__PURE__*/_jsx(ListTabs,{film:film})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"catalog catalog--like-this\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"catalog__title\",children:\"More like this\"}),isSimilarFilmsLoaded?/*#__PURE__*/_jsx(ListFilms,{films:similarFilms.slice(0,SIMILAR_FILMS_COUNT)}):/*#__PURE__*/_jsx(LoadingScreen,{})]}),/*#__PURE__*/_jsx(Footer,{})]})]});}export default FilmPage;","map":{"version":3,"names":["useEffect","Link","useNavigate","useParams","ButtonAddMyList","Footer","ListFilms","LoginUser","Logo","ListTabs","APIRoute","AppRoute","useAppDispatch","useAppSelector","redirectToRoute","fetchLoadCommentsAction","fetchLoadFilmAction","fetchLoadSimilarFilmsAction","getFilm","getSimilarFilms","getFilmFoundStatus","getAuthorizationStatus","isCheckedLogin","LoadingScreen","SIMILAR_FILMS_COUNT","FilmPage","id","navigate","dispatch","film","similarFilms","isSimilarFilmsLoaded","authorizationStatus","isFilmNotFound","NotFound","name","genre","released","posterImage","backgroundImage","clickHandle","Number","Films","slice"],"sources":["D:/frontend/Курсы фронтенд/274941-what-to-watch-10/project/src/pages/film-page/film-page.tsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { Link, useNavigate, useParams } from 'react-router-dom';\nimport ButtonAddMyList from '../../components/button-add-my-list/button-add-my-list';\nimport Footer from '../../components/footer/footer';\nimport ListFilms from '../../components/list-films/list-films';\nimport LoginUser from '../../components/login-user/login-user';\nimport Logo from '../../components/logo/logo';\nimport ListTabs from '../../components/tabs/list-tabs/list-tabs';\nimport { APIRoute, AppRoute } from '../../const';\nimport { useAppDispatch, useAppSelector } from '../../hooks';\nimport { redirectToRoute } from '../../store/action';\nimport {\n  fetchLoadCommentsAction, fetchLoadFilmAction, fetchLoadSimilarFilmsAction\n} from '../../store/api-actions';\nimport { getFilm, getSimilarFilms } from '../../store/data-loading/selector';\nimport { getFilmFoundStatus } from '../../store/film-screening/selector';\nimport { getAuthorizationStatus } from '../../store/user-process/selector';\nimport { isCheckedLogin } from '../../utils';\nimport LoadingScreen from '../loading-screen/loading-screen';\n\nconst SIMILAR_FILMS_COUNT = 4;\n\nfunction FilmPage(): JSX.Element | null {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const dispatch = useAppDispatch();\n\n  const film = useAppSelector(getFilm);\n  const similarFilms = useAppSelector(getSimilarFilms);\n  const isSimilarFilmsLoaded = useAppSelector(getSimilarFilms);\n  const authorizationStatus = useAppSelector(getAuthorizationStatus);\n  const isFilmNotFound = useAppSelector(getFilmFoundStatus);\n\n\n  useEffect(() => {\n    dispatch(fetchLoadCommentsAction(id));\n    dispatch(fetchLoadFilmAction(id));\n    dispatch(fetchLoadSimilarFilmsAction(id));\n  }, [dispatch, id]);\n\n\n  if (isFilmNotFound) {\n    dispatch(redirectToRoute(AppRoute.NotFound));\n  }\n\n  if (!film || !similarFilms) {\n    return <LoadingScreen />;\n  }\n\n  const { name, genre, released, posterImage, backgroundImage } = film;\n  const clickHandle = () => navigate(`/player/${film.id}`);\n\n  return (\n    <>\n      <section className=\"film-card film-card--full\">\n        <div className=\"film-card__hero\">\n          <div className=\"film-card__bg\">\n            <img src={backgroundImage} alt={name} />\n          </div>\n          <h1 className=\"visually-hidden\">WTW</h1>\n          <header className=\"page-header film-card__head\">\n            <Logo />\n            <LoginUser />\n          </header>\n          <div className=\"film-card__wrap\">\n            <div className=\"film-card__desc\">\n              <h2 className=\"film-card__title\">{name}</h2>\n              <p className=\"film-card__meta\">\n                <span className=\"film-card__genre\">{genre}</span>\n                <span className=\"film-card__year\">{released}</span>\n              </p>\n              <div className=\"film-card__buttons\">\n                <button onClick={clickHandle} className=\"btn btn--play film-card__button\" type=\"button\">\n                  <svg viewBox=\"0 0 19 19\" width=\"19\" height=\"19\">\n                    <use xlinkHref=\"#play-s\"></use>\n                  </svg>\n                  <span>Play</span>\n                </button>\n                {\n                  isCheckedLogin(authorizationStatus)\n                    ? <ButtonAddMyList idFilm={Number(id)} />\n                    : ''\n                }\n                {\n                  isCheckedLogin(authorizationStatus)\n                    ? <Link to={`${APIRoute.Films}/${id}/review`} className=\"btn film-card__button\">Add review</Link>\n                    : ''\n                }\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"film-card__wrap film-card__translate-top\">\n          <div className=\"film-card__info\">\n            <div className=\"film-card__poster film-card__poster--big\">\n              <img src={posterImage} alt={`${name} poster`} width=\"218\" height=\"327\" />\n            </div>\n            <ListTabs film={film} />\n          </div>\n        </div>\n      </section>\n      <div className=\"page-content\">\n        <section className=\"catalog catalog--like-this\">\n          <h2 className=\"catalog__title\">More like this</h2>\n          {\n            isSimilarFilmsLoaded\n              ? <ListFilms films={similarFilms.slice(0, SIMILAR_FILMS_COUNT)} />\n              : <LoadingScreen />\n          }\n        </section>\n        <Footer />\n      </div>\n    </>\n  );\n}\n\nexport default FilmPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}