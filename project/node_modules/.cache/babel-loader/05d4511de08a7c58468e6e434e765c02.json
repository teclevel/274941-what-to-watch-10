{"ast":null,"code":"import _defineProperty from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Fragment,useState,useEffect}from'react';import{useNavigate,useParams}from'react-router-dom';import{APIRoute}from'../../const';import{useAppDispatch,useAppSelector}from'../../hooks';import{fetchCommentSendAction}from'../../store/api-actions';import{getDisabledFormStatus}from'../../store/form-state/selector';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var stars=[10,9,8,7,6,5,4,3,2,1];var MIN_COMMENT_LENGTH=50;var MAX_COMMENT_LENGTH=400;function Form(){var _useParams=useParams(),id=_useParams.id;var navigate=useNavigate();var dispatch=useAppDispatch();var isFormDisabled=useAppSelector(getDisabledFormStatus);var initialState={id:id,comment:'',rating:0};var _useState=useState(initialState),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isButtonSubmitDisabled=_useState4[0],setIsButtonSubmitDisabled=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),lengthComment=_useState6[0],setLengthComment=_useState6[1];useEffect(function(){if(lengthComment>=MIN_COMMENT_LENGTH&&lengthComment<=MAX_COMMENT_LENGTH&&formData.rating>0){setIsButtonSubmitDisabled(false);}else{setIsButtonSubmitDisabled(true);}},[formData.rating,lengthComment]);var submitFormHandle=function submitFormHandle(evt){evt.preventDefault();dispatch(fetchCommentSendAction(formData));navigate(\"\".concat(APIRoute.Films,\"/\").concat(id));setFormData(initialState);};var changeRatingHandle=function changeRatingHandle(_ref){var target=_ref.target;var name=target.name,value=target.value;setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},name,value)));};var changeReviewHandle=function changeReviewHandle(_ref2){var target=_ref2.target;var name=target.name,value=target.value;setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},name,value)));setLengthComment(value.length);};return/*#__PURE__*/_jsxs(\"form\",{action:\"#\",className:\"add-review__form\",onSubmit:submitFormHandle,children:[/*#__PURE__*/_jsx(\"div\",{className:\"rating\",children:/*#__PURE__*/_jsx(\"div\",{className:\"rating__stars\",children:stars.map(function(star){return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{className:\"rating__input\",type:\"radio\",name:\"rating\",id:\"star-\".concat(star),value:star,onChange:changeRatingHandle,disabled:isFormDisabled}),/*#__PURE__*/_jsxs(\"label\",{className:\"rating__label\",htmlFor:\"star-\".concat(star),children:[\"Rating \",star]})]},star);})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"add-review__text\",children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"add-review__textarea\",name:\"comment\",id:\"review-text\",placeholder:\"Review text\",value:formData.comment,onChange:changeReviewHandle,disabled:isFormDisabled}),/*#__PURE__*/_jsx(\"div\",{className:\"add-review__submit\",children:/*#__PURE__*/_jsx(\"button\",{className:\"add-review__btn\",type:\"submit\",disabled:isButtonSubmitDisabled,children:\"Post\"})})]})]});}export default Form;","map":{"version":3,"names":["Fragment","useState","useEffect","useNavigate","useParams","APIRoute","useAppDispatch","useAppSelector","fetchCommentSendAction","getDisabledFormStatus","stars","MIN_COMMENT_LENGTH","MAX_COMMENT_LENGTH","Form","id","navigate","dispatch","isFormDisabled","initialState","comment","rating","formData","setFormData","isButtonSubmitDisabled","setIsButtonSubmitDisabled","lengthComment","setLengthComment","submitFormHandle","evt","preventDefault","Films","changeRatingHandle","target","name","value","changeReviewHandle","length","map","star"],"sources":["D:/frontend/Курсы фронтенд/274941-what-to-watch-10/project/src/components/form/form.tsx"],"sourcesContent":["import { FormEvent, Fragment, useState, ChangeEvent, useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { APIRoute } from '../../const';\nimport { useAppDispatch, useAppSelector } from '../../hooks';\nimport { fetchCommentSendAction } from '../../store/api-actions';\nimport { getDisabledFormStatus } from '../../store/form-state/selector';\n\nconst stars = [10, 9, 8, 7, 6, 5, 4, 3, 2, 1];\nconst MIN_COMMENT_LENGTH = 50;\nconst MAX_COMMENT_LENGTH = 400;\n\nfunction Form() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const dispatch = useAppDispatch();\n  const isFormDisabled = useAppSelector(getDisabledFormStatus);\n\n  const initialState = {\n    id: id,\n    comment: '',\n    rating: 0\n  };\n\n  const [formData, setFormData] = useState(initialState);\n  const [isButtonSubmitDisabled, setIsButtonSubmitDisabled] = useState(true);\n  const [lengthComment, setLengthComment] = useState(0);\n\n  useEffect(() => {\n    if (lengthComment >= MIN_COMMENT_LENGTH\n      && lengthComment <= MAX_COMMENT_LENGTH\n      && formData.rating > 0) {\n      setIsButtonSubmitDisabled(false);\n    } else {\n      setIsButtonSubmitDisabled(true);\n    }\n  }, [formData.rating, lengthComment]);\n\n  const submitFormHandle = (evt: FormEvent<HTMLFormElement>) => {\n    evt.preventDefault();\n    dispatch(fetchCommentSendAction(formData));\n    navigate(`${APIRoute.Films}/${id}`);\n    setFormData(initialState);\n  };\n\n  const changeRatingHandle = ({ target }: ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = target;\n    setFormData({ ...formData, [name]: value });\n  };\n\n  const changeReviewHandle = ({ target }: ChangeEvent<HTMLTextAreaElement>) => {\n    const { name, value } = target;\n    setFormData({ ...formData, [name]: value });\n    setLengthComment(value.length);\n  };\n\n  return (\n    <form action=\"#\" className=\"add-review__form\" onSubmit={submitFormHandle}>\n      <div className=\"rating\">\n        <div className=\"rating__stars\">\n          {\n            stars.map((star) => (\n              <Fragment key={star}>\n                <input className=\"rating__input\" type=\"radio\" name=\"rating\"\n                  id={`star-${star}`}\n                  value={star}\n                  onChange={changeRatingHandle}\n                  disabled={isFormDisabled}\n                />\n                <label className=\"rating__label\" htmlFor={`star-${star}`}>Rating {star}</label>\n              </Fragment>\n            ))\n          }\n        </div>\n      </div>\n\n      <div className=\"add-review__text\">\n        <textarea className=\"add-review__textarea\" name=\"comment\" id=\"review-text\" placeholder=\"Review text\"\n          value={formData.comment}\n          onChange={changeReviewHandle}\n          disabled={isFormDisabled}\n        >\n        </textarea>\n        <div className=\"add-review__submit\">\n          <button className=\"add-review__btn\" type=\"submit\" disabled={isButtonSubmitDisabled}>Post</button>\n        </div>\n      </div>\n\n    </form>\n  );\n}\n\nexport default Form;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}