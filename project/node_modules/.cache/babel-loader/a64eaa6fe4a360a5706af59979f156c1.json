{"ast":null,"code":"import _regeneratorRuntime from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useEffect}from'react';import{useAppDispatch,useAppSelector}from'../../hooks';import{fetchChangeViewStatusAction,fetchLoadFavoriteFilmsAction}from'../../store/api-actions';import{getFavoriteFilms}from'../../store/favorite-state/selector';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ButtonAddMyList(_ref){var idFilm=_ref.idFilm;var favoriteFilms=useAppSelector(getFavoriteFilms);var dispatch=useAppDispatch();useEffect(function(){dispatch(fetchLoadFavoriteFilmsAction());},[dispatch]);var onClickViewStatus=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(fetchChangeViewStatusAction({idFilm:idFilm,status:isFavorite?0:1}));case 2:_context.next=4;return dispatch(fetchLoadFavoriteFilmsAction());case 4:case\"end\":return _context.stop();}}},_callee);}));return function onClickViewStatus(){return _ref2.apply(this,arguments);};}();if(!favoriteFilms){return null;}var isFavorite=favoriteFilms.some(function(film){return film.id===idFilm;});return/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn--list film-card__button\",type:\"button\",onClick:onClickViewStatus,children:[isFavorite?/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 18 14\",width:\"18\",height:\"14\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"#in-list\"})}):/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 19 20\",width:\"19\",height:\"20\",children:/*#__PURE__*/_jsx(\"use\",{xlinkHref:\"#add\"})}),/*#__PURE__*/_jsx(\"span\",{children:\"My list\"}),/*#__PURE__*/_jsx(\"span\",{className:\"film-card__count\",children:favoriteFilms.length})]});}export default ButtonAddMyList;","map":{"version":3,"names":["useEffect","useAppDispatch","useAppSelector","fetchChangeViewStatusAction","fetchLoadFavoriteFilmsAction","getFavoriteFilms","ButtonAddMyList","idFilm","favoriteFilms","dispatch","onClickViewStatus","status","isFavorite","some","film","id","length"],"sources":["D:/frontend/Курсы фронтенд/274941-what-to-watch-10/project/src/components/button-add-my-list/button-add-my-list.tsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { useAppDispatch, useAppSelector } from '../../hooks';\nimport {\n  fetchChangeViewStatusAction, fetchLoadFavoriteFilmsAction\n} from '../../store/api-actions';\nimport { getFavoriteFilms } from '../../store/favorite-state/selector';\n\n\ntype ButtonAddMyListProps = {\n  idFilm: number,\n}\n\nfunction ButtonAddMyList({ idFilm }: ButtonAddMyListProps): JSX.Element | null {\n  const favoriteFilms = useAppSelector(getFavoriteFilms);\n  const dispatch = useAppDispatch();\n\n  useEffect(() => {\n    dispatch(fetchLoadFavoriteFilmsAction());\n  }, [dispatch]);\n\n  const onClickViewStatus = async () => {\n    await dispatch(fetchChangeViewStatusAction({ idFilm, status: isFavorite ? 0 : 1 }));\n    await dispatch(fetchLoadFavoriteFilmsAction());\n  };\n\n  if (!favoriteFilms) { return null; }\n  const isFavorite = favoriteFilms.some((film) => film.id === idFilm);\n\n  return (\n    <button className=\"btn btn--list film-card__button\"\n      type=\"button\"\n      onClick={onClickViewStatus}\n    >\n      {\n        isFavorite\n          ?\n          <svg viewBox=\"0 0 18 14\" width=\"18\" height=\"14\">\n            <use xlinkHref=\"#in-list\"></use>\n          </svg>\n          :\n          <svg viewBox=\"0 0 19 20\" width=\"19\" height=\"20\">\n            <use xlinkHref=\"#add\"></use>\n          </svg>\n      }\n      <span>My list</span>\n      <span className=\"film-card__count\">{favoriteFilms.length}</span>\n    </button>\n  );\n}\n\nexport default ButtonAddMyList;\n"],"mappings":"kbAAA,OAASA,SAAT,KAA0B,OAA1B,CACA,OAASC,cAAT,CAAyBC,cAAzB,KAA+C,aAA/C,CACA,OACEC,2BADF,CAC+BC,4BAD/B,KAEO,yBAFP,CAGA,OAASC,gBAAT,KAAiC,qCAAjC,C,wFAOA,QAASC,gBAAT,MAA+E,IAApDC,OAAoD,MAApDA,MAAoD,CAC7E,GAAMC,cAAa,CAAGN,cAAc,CAACG,gBAAD,CAApC,CACA,GAAMI,SAAQ,CAAGR,cAAc,EAA/B,CAEAD,SAAS,CAAC,UAAM,CACdS,QAAQ,CAACL,4BAA4B,EAA7B,CAAR,CACD,CAFQ,CAEN,CAACK,QAAD,CAFM,CAAT,CAIA,GAAMC,kBAAiB,6FAAG,2JAClBD,SAAQ,CAACN,2BAA2B,CAAC,CAAEI,MAAM,CAANA,MAAF,CAAUI,MAAM,CAAEC,UAAU,CAAG,CAAH,CAAO,CAAnC,CAAD,CAA5B,CADU,8BAElBH,SAAQ,CAACL,4BAA4B,EAA7B,CAFU,uDAAH,kBAAjBM,kBAAiB,2CAAvB,CAKA,GAAI,CAACF,aAAL,CAAoB,CAAE,MAAO,KAAP,CAAc,CACpC,GAAMI,WAAU,CAAGJ,aAAa,CAACK,IAAd,CAAmB,SAACC,IAAD,QAAUA,KAAI,CAACC,EAAL,GAAYR,MAAtB,EAAnB,CAAnB,CAEA,mBACE,gBAAQ,SAAS,CAAC,iCAAlB,CACE,IAAI,CAAC,QADP,CAEE,OAAO,CAAEG,iBAFX,WAKIE,UAAU,cAER,YAAK,OAAO,CAAC,WAAb,CAAyB,KAAK,CAAC,IAA/B,CAAoC,MAAM,CAAC,IAA3C,uBACE,YAAK,SAAS,CAAC,UAAf,EADF,EAFQ,cAMR,YAAK,OAAO,CAAC,WAAb,CAAyB,KAAK,CAAC,IAA/B,CAAoC,MAAM,CAAC,IAA3C,uBACE,YAAK,SAAS,CAAC,MAAf,EADF,EAXN,cAeE,iCAfF,cAgBE,aAAM,SAAS,CAAC,kBAAhB,UAAoCJ,aAAa,CAACQ,MAAlD,EAhBF,GADF,CAoBD,CAED,cAAeV,gBAAf"},"metadata":{},"sourceType":"module"}