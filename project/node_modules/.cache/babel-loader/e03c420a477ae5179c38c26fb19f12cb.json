{"ast":null,"code":"import _regeneratorRuntime from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/frontend/\\u041A\\u0443\\u0440\\u0441\\u044B \\u0444\\u0440\\u043E\\u043D\\u0442\\u0435\\u043D\\u0434/274941-what-to-watch-10/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{createAsyncThunk}from'@reduxjs/toolkit';import{APIRoute,AppRoute}from'../const';import{dropToken,saveToken}from'../services/token';import{redirectToRoute}from'./action';import{setFormDisabled}from'./form-state/form-state';export var fetchLoadFilmsAction=createAsyncThunk('data/fetchFilms',/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_arg,_ref){var dispatch,api,_yield$api$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch=_ref.dispatch,api=_ref.extra;_context.next=3;return api.get(APIRoute.Films);case 3:_yield$api$get=_context.sent;data=_yield$api$get.data;return _context.abrupt(\"return\",data);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref2.apply(this,arguments);};}());export var fetchLoadSimilarFilmsAction=createAsyncThunk('data/fetchSimilarFilms',/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(id,_ref3){var dispatch,api,_yield$api$get2,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch=_ref3.dispatch,api=_ref3.extra;_context2.next=3;return api.get(\"\".concat(APIRoute.Films,\"/\").concat(id,\"/similar\"));case 3:_yield$api$get2=_context2.sent;data=_yield$api$get2.data;return _context2.abrupt(\"return\",data);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3,_x4){return _ref4.apply(this,arguments);};}());export var fetchLoadPromoAction=createAsyncThunk('data/fetchLoadPromo',/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_arg,_ref5){var dispatch,api,_yield$api$get3,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch=_ref5.dispatch,api=_ref5.extra;_context3.next=3;return api.get(APIRoute.Promo);case 3:_yield$api$get3=_context3.sent;data=_yield$api$get3.data;return _context3.abrupt(\"return\",data);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x5,_x6){return _ref6.apply(this,arguments);};}());export var checkAuthAction=createAsyncThunk('user/checkAuth',/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(_arg,_ref7){var dispatch,api;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch=_ref7.dispatch,api=_ref7.extra;_context4.next=3;return api.get(APIRoute.Login);case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x7,_x8){return _ref8.apply(this,arguments);};}());export var fetchLoadCommentsAction=createAsyncThunk('data/fetchLoadComment',/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(id,_ref9){var dispatch,api,_yield$api$get4,data;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:dispatch=_ref9.dispatch,api=_ref9.extra;_context5.next=3;return api.get(\"\".concat(APIRoute.Comments,\"/\").concat(id));case 3:_yield$api$get4=_context5.sent;data=_yield$api$get4.data;return _context5.abrupt(\"return\",data);case 6:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x9,_x10){return _ref10.apply(this,arguments);};}());export var fetchCommentSendAction=createAsyncThunk('user/fetchSendComment',/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(_ref11,_ref12){var id,comment,rating,dispatch,api;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:id=_ref11.id,comment=_ref11.comment,rating=_ref11.rating;dispatch=_ref12.dispatch,api=_ref12.extra;_context6.prev=2;dispatch(setFormDisabled(true));_context6.next=6;return api.post(\"\".concat(APIRoute.Comments,\"/ \").concat(id),{comment:comment,rating:rating});case 6:dispatch(setFormDisabled(false));_context6.next=12;break;case 9:_context6.prev=9;_context6.t0=_context6[\"catch\"](2);dispatch(setFormDisabled(false));case 12:case\"end\":return _context6.stop();}}},_callee6,null,[[2,9]]);}));return function(_x11,_x12){return _ref13.apply(this,arguments);};}());export var fetchLoadFilmAction=createAsyncThunk('data/fetchLoadFilm',/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(id,_ref14){var dispatch,api,_yield$api$get5,data;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:dispatch=_ref14.dispatch,api=_ref14.extra;_context7.next=3;return api.get(\"\".concat(APIRoute.Films,\"/\").concat(id));case 3:_yield$api$get5=_context7.sent;data=_yield$api$get5.data;return _context7.abrupt(\"return\",data);case 6:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x13,_x14){return _ref15.apply(this,arguments);};}());export var loginAction=createAsyncThunk('user/login',/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref16,_ref17){var email,password,dispatch,api,_yield$api$post,token;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:email=_ref16.login,password=_ref16.password;dispatch=_ref17.dispatch,api=_ref17.extra;_context8.next=4;return api.post(APIRoute.Login,{email:email,password:password});case 4:_yield$api$post=_context8.sent;token=_yield$api$post.data.token;saveToken(token);dispatch(redirectToRoute(AppRoute.Main));case 8:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x15,_x16){return _ref18.apply(this,arguments);};}());export var logoutAction=createAsyncThunk('user/logout',/*#__PURE__*/function(){var _ref20=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_arg,_ref19){var dispatch,api;return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:dispatch=_ref19.dispatch,api=_ref19.extra;_context9.next=3;return api.delete(APIRoute.Logout);case 3:dropToken();case 4:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x17,_x18){return _ref20.apply(this,arguments);};}());export var fetchChangeViewStatusAction=createAsyncThunk('user/fetchChangeViewStatusAction',/*#__PURE__*/function(){var _ref23=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(_ref21,_ref22){var idFilm,status,dispatch,api;return _regeneratorRuntime().wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:idFilm=_ref21.idFilm,status=_ref21.status;dispatch=_ref22.dispatch,api=_ref22.extra;_context10.next=4;return api.post(\"\".concat(APIRoute.Favorite,\"/ \").concat(idFilm,\" /\").concat(status),{idFilm:idFilm,status:status});case 4:case\"end\":return _context10.stop();}}},_callee10);}));return function(_x19,_x20){return _ref23.apply(this,arguments);};}());export var fetchLoadFavoriteFilmsAction=createAsyncThunk('favorite/fetchFavoriteFilms',/*#__PURE__*/function(){var _ref25=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(_arg,_ref24){var dispatch,api,_yield$api$get6,data;return _regeneratorRuntime().wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:dispatch=_ref24.dispatch,api=_ref24.extra;_context11.next=3;return api.get(APIRoute.Favorite);case 3:_yield$api$get6=_context11.sent;data=_yield$api$get6.data;return _context11.abrupt(\"return\",data);case 6:case\"end\":return _context11.stop();}}},_callee11);}));return function(_x21,_x22){return _ref25.apply(this,arguments);};}());","map":{"version":3,"names":["createAsyncThunk","APIRoute","AppRoute","dropToken","saveToken","redirectToRoute","setFormDisabled","fetchLoadFilmsAction","_arg","dispatch","api","extra","get","Films","data","fetchLoadSimilarFilmsAction","id","fetchLoadPromoAction","Promo","checkAuthAction","Login","fetchLoadCommentsAction","Comments","fetchCommentSendAction","comment","rating","post","fetchLoadFilmAction","loginAction","email","login","password","token","Main","logoutAction","delete","Logout","fetchChangeViewStatusAction","idFilm","status","Favorite","fetchLoadFavoriteFilmsAction"],"sources":["D:/frontend/Курсы фронтенд/274941-what-to-watch-10/project/src/store/api-actions.ts"],"sourcesContent":["import { createAsyncThunk } from '@reduxjs/toolkit';\nimport { AxiosInstance } from 'axios';\nimport { APIRoute, AppRoute } from '../const';\nimport { dropToken, saveToken } from '../services/token';\nimport { AuthData } from '../types/auth-data';\nimport { StatusFavorite } from '../types/favorite';\nimport { Film, Films } from '../types/films';\nimport { Comment, Reviews } from '../types/reviews';\nimport { AppDispatch, State } from '../types/state';\nimport { UserData } from '../types/user-data';\nimport { redirectToRoute } from './action';\nimport { setFormDisabled } from './form-state/form-state';\n\n\nexport const fetchLoadFilmsAction = createAsyncThunk<Films, string | undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'data/fetchFilms',\n  async (_arg, { dispatch, extra: api }) => {\n    const { data } = await api.get<Films>(APIRoute.Films);\n    return data;\n  },\n);\n\nexport const fetchLoadSimilarFilmsAction = createAsyncThunk<Films, string | undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'data/fetchSimilarFilms',\n  async (id, { dispatch, extra: api }) => {\n    const { data } = await api.get<Films>(`${APIRoute.Films}/${id}/similar`);\n    return data;\n  },\n);\n\nexport const fetchLoadPromoAction = createAsyncThunk<Film, undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'data/fetchLoadPromo',\n  async (_arg, { dispatch, extra: api }) => {\n    const { data } = await api.get<Film>(APIRoute.Promo);\n    return data;\n  },\n);\n\nexport const checkAuthAction = createAsyncThunk<void, undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'user/checkAuth',\n  async (_arg, { dispatch, extra: api }) => {\n    await api.get(APIRoute.Login);\n  },\n);\n\nexport const fetchLoadCommentsAction = createAsyncThunk<Reviews, string | undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'data/fetchLoadComment',\n  async (id, { dispatch, extra: api }) => {\n    const { data } = await api.get<Reviews>(`${APIRoute.Comments}/${id}`);\n    return data;\n  },\n);\n\nexport const fetchCommentSendAction = createAsyncThunk<void, Comment, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'user/fetchSendComment',\n  async ({ id, comment, rating }, { dispatch, extra: api }) => {\n    try {\n      dispatch(setFormDisabled(true));\n      await api.post<Comment>(`${APIRoute.Comments}/ ${id}`, { comment, rating });\n      dispatch(setFormDisabled(false));\n\n    } catch {\n      dispatch(setFormDisabled(false));\n    }\n  },\n);\n\nexport const fetchLoadFilmAction = createAsyncThunk<Film, string | undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'data/fetchLoadFilm',\n  async (id, { dispatch, extra: api }) => {\n    const { data } = await api.get<Film>(`${APIRoute.Films}/${id}`);\n    return data;\n  },\n);\n\nexport const loginAction = createAsyncThunk<void, AuthData, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'user/login',\n  async ({ login: email, password }, { dispatch, extra: api }) => {\n    const { data: { token } } = await api.post<UserData>(APIRoute.Login, { email, password });\n    saveToken(token);\n    dispatch(redirectToRoute(AppRoute.Main));\n  },\n);\n\nexport const logoutAction = createAsyncThunk<void, undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'user/logout',\n  async (_arg, { dispatch, extra: api }) => {\n    await api.delete(APIRoute.Logout);\n    dropToken();\n  },\n);\n\nexport const fetchChangeViewStatusAction = createAsyncThunk<void, StatusFavorite, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'user/fetchChangeViewStatusAction',\n  async ({ idFilm, status }, { dispatch, extra: api }) => {\n    await api.post<StatusFavorite>(`${APIRoute.Favorite}/ ${idFilm} /${status}`, { idFilm, status });\n  },\n);\n\nexport const fetchLoadFavoriteFilmsAction = createAsyncThunk<Films, string | undefined, {\n  dispatch: AppDispatch,\n  state: State,\n  extra: AxiosInstance\n}>(\n  'favorite/fetchFavoriteFilms',\n  async (_arg, { dispatch, extra: api }) => {\n    const { data } = await api.get<Films>(APIRoute.Favorite);\n    return data;\n  },\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}